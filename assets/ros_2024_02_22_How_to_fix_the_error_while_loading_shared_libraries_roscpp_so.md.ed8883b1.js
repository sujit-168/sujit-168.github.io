import{_ as r}from"./chunks/ArticleMetadata.baab749e.js";import{_ as t,C as c,o as n,c as i,H as d,w as y,k as e,a as h,Q as u,b,e as F}from"./chunks/framework.fcce45dc.js";import"./chunks/md5.3e7612d8.js";const q=JSON.parse('{"title":"如何修复 roscore 加载共享库时的错误：libroscpp.so","description":"","frontmatter":{"title":"如何修复 roscore 加载共享库时的错误：libroscpp.so","date":"2024-02-22 09:58","categories":["ROS"],"tags":["ROS"],"copyright":true},"headers":[],"relativePath":"ros/2024/02/22/How_to_fix_the_error_while_loading_shared_libraries_roscpp_so.md","filePath":"ros/2024/02/22/How_to_fix_the_error_while_loading_shared_libraries_roscpp_so.md","lastUpdated":1711185179000}'),C={name:"ros/2024/02/22/How_to_fix_the_error_while_loading_shared_libraries_roscpp_so.md"},m=e("h1",{id:"如何修复-roscore-加载共享库时的错误-libroscpp-so",tabindex:"-1"},[h("如何修复 roscore 加载共享库时的错误：libroscpp.so "),e("a",{class:"header-anchor",href:"#如何修复-roscore-加载共享库时的错误-libroscpp-so","aria-label":'Permalink to "如何修复 roscore 加载共享库时的错误：libroscpp.so"'},"​")],-1),_=u(`<p>前天折腾了一下在 <a href="https://www.waveshare.net/wiki/Horizon_Sunrise_X3_PI" target="_blank" rel="noreferrer">X3pi</a> 上安装 ROS Noetic 时，遇到的一个问题，在 roscore 加载共享库时出错，之前没遇到过，记录一下。</p><h2 id="问题描述" tabindex="-1">问题描述 <a class="header-anchor" href="#问题描述" aria-label="Permalink to &quot;问题描述&quot;">​</a></h2><p>在执行 <code>roscore</code> 时，出现了如下错误：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">$</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">roscore</span></span>
<span class="line"><span style="color:#6CB6FF;">....</span></span>
<span class="line"><span style="color:#F69D50;">process[rosout-1]:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">started</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">with</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">pid</span><span style="color:#ADBAC7;"> [9673]</span></span>
<span class="line"><span style="color:#ADBAC7;">[rosout-1] process has died [pid </span><span style="color:#6CB6FF;">9673</span><span style="color:#ADBAC7;">, exit code </span><span style="color:#6CB6FF;">127</span><span style="color:#ADBAC7;">, cnd /opt/ros/noetic/lib/rosout/rosout nane </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">rosout_ log:</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">/hone/ouc/.ros/log/0753254-d0a1-11ea8ecb-1c1b6d253d41/rosout-1</span><span style="color:#F47067;">*</span><span style="color:#ADBAC7;">.log].</span></span>
<span class="line"><span style="color:#F69D50;">log</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">file:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/hone/ouc/.ros/log/0753254-d0a1-11ea8ecb-1c1b6d253d41/rosout-1</span><span style="color:#6CB6FF;">*</span><span style="color:#96D0FF;">.log</span></span>
<span class="line"><span style="color:#ADBAC7;">[ rosout-1] restarting process</span></span>
<span class="line"><span style="color:#F69D50;">/opt/ros/noetic/lib/rosout/rosout:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">error</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">while</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">loading</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">shared</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">libraries:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">libroscpp.so:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">cannot</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">open</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">shared</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">object</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">file:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">No</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">such</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">file</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">or</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">directory</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">roscore</span></span>
<span class="line"><span style="color:#005CC5;">....</span></span>
<span class="line"><span style="color:#6F42C1;">process[rosout-1]:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">started</span><span style="color:#24292E;"> </span><span style="color:#032F62;">with</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pid</span><span style="color:#24292E;"> [9673]</span></span>
<span class="line"><span style="color:#24292E;">[rosout-1] process has died [pid </span><span style="color:#005CC5;">9673</span><span style="color:#24292E;">, exit code </span><span style="color:#005CC5;">127</span><span style="color:#24292E;">, cnd /opt/ros/noetic/lib/rosout/rosout nane </span><span style="color:#D73A49;">=</span><span style="color:#24292E;">rosout_ log:</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">/hone/ouc/.ros/log/0753254-d0a1-11ea8ecb-1c1b6d253d41/rosout-1</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.log].</span></span>
<span class="line"><span style="color:#6F42C1;">log</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/hone/ouc/.ros/log/0753254-d0a1-11ea8ecb-1c1b6d253d41/rosout-1</span><span style="color:#005CC5;">*</span><span style="color:#032F62;">.log</span></span>
<span class="line"><span style="color:#24292E;">[ rosout-1] restarting process</span></span>
<span class="line"><span style="color:#6F42C1;">/opt/ros/noetic/lib/rosout/rosout:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">error</span><span style="color:#24292E;"> </span><span style="color:#032F62;">while</span><span style="color:#24292E;"> </span><span style="color:#032F62;">loading</span><span style="color:#24292E;"> </span><span style="color:#032F62;">shared</span><span style="color:#24292E;"> </span><span style="color:#032F62;">libraries:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">libroscpp.so:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cannot</span><span style="color:#24292E;"> </span><span style="color:#032F62;">open</span><span style="color:#24292E;"> </span><span style="color:#032F62;">shared</span><span style="color:#24292E;"> </span><span style="color:#032F62;">object</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">No</span><span style="color:#24292E;"> </span><span style="color:#032F62;">such</span><span style="color:#24292E;"> </span><span style="color:#032F62;">file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">directory</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="问题分析" tabindex="-1">问题分析 <a class="header-anchor" href="#问题分析" aria-label="Permalink to &quot;问题分析&quot;">​</a></h2><p>根据错误提示，应该是 <code>libroscpp.so</code> 加载失败。</p><h3 id="_1-检查共享库是否存在" tabindex="-1">1. 检查共享库是否存在 <a class="header-anchor" href="#_1-检查共享库是否存在" aria-label="Permalink to &quot;1. 检查共享库是否存在&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">find</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/opt/ros</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-name</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;libroscpp.so&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">find</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/ros</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;libroscpp.so&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>输出：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">/opt/ros/noetic/lib/libroscpp.so</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">/opt/ros/noetic/lib/libroscpp.so</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>发现共享库存在，说明共享库的路径是正确的，接下来就需要查看一下环境变量是否正确了。</p><h3 id="_2-检查环境变量是否正确" tabindex="-1">2. 检查环境变量是否正确 <a class="header-anchor" href="#_2-检查环境变量是否正确" aria-label="Permalink to &quot;2. 检查环境变量是否正确&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#6CB6FF;">echo</span><span style="color:#ADBAC7;"> $LD_LIBRARY_PATH</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> $LD_LIBRARY_PATH</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>输出：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">/opt/ros/noetic/lib</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">/opt/ros/noetic/lib</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>发现环境变量是正确的，这就奇怪了。</p><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h2><p>参考文章<a href="https://blog.csdn.net/weixin_46639310/article/details/133024546" target="_blank" rel="noreferrer">error while loading shared libraries: libroscpp.so: cannot open shared object file</a></p><h3 id="_1-添加路径到配置文件" tabindex="-1">1.添加路径到配置文件 <a class="header-anchor" href="#_1-添加路径到配置文件" aria-label="Permalink to &quot;1.添加路径到配置文件&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">sudo</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">cat</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/etc/ld.so.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ld.so.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>然后将共享库的路径添加到配置文件中：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">include</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/etc/ld.so.conf.d/</span><span style="color:#6CB6FF;">*</span><span style="color:#96D0FF;">.conf</span></span>
<span class="line"><span style="color:#F69D50;">/opt/ros/noetic/lib</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ld.so.conf.d/</span><span style="color:#005CC5;">*</span><span style="color:#032F62;">.conf</span></span>
<span class="line"><span style="color:#6F42C1;">/opt/ros/noetic/lib</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后 <code>ESC</code>，输入<code>:wq</code> 保存并退出。</p><h3 id="_2-重新加载配置文件" tabindex="-1">2. 重新加载配置文件 <a class="header-anchor" href="#_2-重新加载配置文件" aria-label="Permalink to &quot;2. 重新加载配置文件&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">sudo</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">ldconfig</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ldconfig</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>再次运行 <code>roscore</code> 即可成功。</p>`,26);function A(s,g,D,v,B,k){const l=r,p=c("ClientOnly");return n(),i("div",null,[m,d(p,null,{default:y(()=>{var a,o;return[(((a=s.$frontmatter)==null?void 0:a.aside)??!0)&&(((o=s.$frontmatter)==null?void 0:o.showArticleMetadata)??!0)?(n(),b(l,{key:0,article:s.$frontmatter},null,8,["article"])):F("",!0)]}),_:1}),_])}const x=t(C,[["render",A]]);export{q as __pageData,x as default};
