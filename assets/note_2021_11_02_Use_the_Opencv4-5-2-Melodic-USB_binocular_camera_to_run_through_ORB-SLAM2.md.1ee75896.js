import{_ as r}from"./chunks/ArticleMetadata.77410820.js";import{_ as t,C as c,o as l,c as i,H as y,w as d,k as p,a as u,Q as F,b as C,e as b}from"./chunks/framework.fcce45dc.js";import"./chunks/md5.3e7612d8.js";const k=JSON.parse('{"title":"用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2","description":"","frontmatter":{"title":"用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2","date":"2021-11-02 11:00","categories":["note"],"tags":["Opencv4.5.2","ORB-SLAM2","Melodic"],"copyright":true},"headers":[],"relativePath":"note/2021/11/02/Use_the_Opencv4-5-2-Melodic-USB_binocular_camera_to_run_through_ORB-SLAM2.md","filePath":"note/2021/11/02/Use_the_Opencv4-5-2-Melodic-USB_binocular_camera_to_run_through_ORB-SLAM2.md","lastUpdated":1711185179000}'),m={name:"note/2021/11/02/Use_the_Opencv4-5-2-Melodic-USB_binocular_camera_to_run_through_ORB-SLAM2.md"},A=p("h1",{id:"用-opencv4-5-2-melodic-usb-双目摄像头跑通-orb-slam2",tabindex:"-1"},[u("用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2 "),p("a",{class:"header-anchor",href:"#用-opencv4-5-2-melodic-usb-双目摄像头跑通-orb-slam2","aria-label":'Permalink to "用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2"'},"​")],-1),h=F(`<h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>在实现的具体过程也踩了不少坑，所以写下这篇文章来总结整个过程。</p><p>入门 SLAM 需要深度相机和激光雷达这些基础硬件，但是考虑到自己的经济实力实在不允许，所以就入手了下面这个摄像头。这个摄像头的具体长这样，是我在淘宝 35 元买来练手的。</p><p><img src="https://img-blog.csdnimg.cn/99b3342d31fa4312baa7745be7a9ca2c.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Sm5YKR,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> 在商家提供的资料外，也发现了不少值得再延申的内容，比如如何在 ROS 下进行双目测距算法，PCL 三维重建，如何联系 ORB-SLAM2 的双目建图等等。一个 idea 有了，接下来就是开始实践。但实践的道路并不像想的那样平坦，也遇到了不少问题，在查资料的过程中，也发现了不少前辈的精辟总结，所以在此处做一下整理</p><ul><li><a href="https://bbs.csdn.net/topics/392285857" target="_blank" rel="noreferrer">ubuntu 下 如何与 usb 设备摄像头通信</a></li><li><a href="https://blog.csdn.net/qq_38288618/article/details/91474026" target="_blank" rel="noreferrer">ros 学习最便宜的双目 Chusei 3d webcam 在 linux 下用 uvcdynctrl 命令控制 结贴</a></li><li><a href="https://www.jianshu.com/p/2ce302d588a0" target="_blank" rel="noreferrer">hack 一个 3D 摄像头来解闷</a></li><li><a href="https://blog.csdn.net/Y_15751004297/article/details/88878200" target="_blank" rel="noreferrer">Ubuntu 下读取 CHUSEI 3D Webcam 双目摄像头 C++ 版本（调用 python 脚本进行配置）</a></li><li><a href="https://blog.csdn.net/qq_41433316/article/details/99118495" target="_blank" rel="noreferrer">双目摄像头的标定及测距（Ubuntu16.04 + OpenCV）</a></li><li><a href="https://blog.csdn.net/hbwhzc/article/details/109136776" target="_blank" rel="noreferrer">在 linux/Ubuntu 下调试最便宜的双目摄像头（含 Linux 版本上位机）CAM5031/CHUSEI 3D WEBCAM 解决只能开单目的问题</a></li><li><a href="https://blog.csdn.net/weixin_44242403/article/details/115749860" target="_blank" rel="noreferrer">windows + python + opencv 打开双目摄像头 chusei3d 踩坑</a> 在前辈的经验加持下，也解决了一些问题。</li></ul><h2 id="问题" tabindex="-1">问题 <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题&quot;">​</a></h2><h3 id="问题一-ubuntu-下的双目模式切换问题" tabindex="-1">问题一：Ubuntu 下的双目模式切换问题 <a class="header-anchor" href="#问题一-ubuntu-下的双目模式切换问题" aria-label="Permalink to &quot;问题一：Ubuntu 下的双目模式切换问题&quot;">​</a></h3><p>商家提供的资料中有 shell 脚本可以使用，但是个人感觉在使用过程中体验并不友好。 所以自己也对脚本进行了一定的改进。注意在使用前需要提权</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">user@ubuntu:</span><span style="color:#F47067;">~/</span><span style="color:#ADBAC7;">Stereo_cam</span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">Camera_switch$ chmod </span><span style="color:#F47067;">+</span><span style="color:#ADBAC7;">x .</span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">camera_switch.sh</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">user@ubuntu:</span><span style="color:#D73A49;">~/</span><span style="color:#24292E;">Stereo_cam</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Camera_switch$ chmod </span><span style="color:#D73A49;">+</span><span style="color:#24292E;">x .</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">camera_switch.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>camera_switch.sh</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">#!/bin/bash</span></span>
<span class="line"><span style="color:#768390;"># user@ubuntu:~/Stereo_cam/Camera_switch$ chmod +x ./camera_switch.sh      提升执行权限</span></span>
<span class="line"><span style="color:#768390;"># author : ruoxi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;%-10s\\n&quot;请输入相机通道</span></span>
<span class="line"><span style="color:#6CB6FF;">read</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">id</span><span style="color:#ADBAC7;">     </span><span style="color:#768390;"># 选取相机通道</span></span>
<span class="line"><span style="color:#6CB6FF;">echo</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-e</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;It is switch to </span><span style="color:#ADBAC7;">$id</span><span style="color:#96D0FF;"> \\n&quot;</span><span style="color:#ADBAC7;">        </span><span style="color:#768390;"># -e 开启转义</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1.左单目模式：LEFT_EYE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;2.右单目模式：RIGHT_EYE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;3.红蓝模式：RED_BLUE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;4.双目模式：BINOCULAR_MODE\\n&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;%-10s\\n&quot;请输入相机输出模式序号</span></span>
<span class="line"><span style="color:#6CB6FF;">read</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">mode</span><span style="color:#ADBAC7;">   </span><span style="color:#768390;"># 切换相机输出模式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;\\n&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:8</span><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">&#39;(LE)0x50ff&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:15</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;(LE)0x00f6&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:8</span><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">&#39;(LE)0x2500&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:8</span><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">&#39;(LE)0x5ffe&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:15</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;(LE)0x0003&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:15</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;(LE)0x0002&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:15</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;(LE)0x0012&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:15</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;(LE)0x0004&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:8</span><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">&#39;(LE)0x76c3&#39;</span></span>
<span class="line"><span style="color:#F69D50;">uvcdynctrl</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/dev/video</span><span style="color:#ADBAC7;">\${id} </span><span style="color:#6CB6FF;">-S</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">6</span><span style="color:#96D0FF;">:10</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;(LE)0x0\${</span><span style="color:#ADBAC7;">mode</span><span style="color:#96D0FF;">}00&quot;</span><span style="color:#ADBAC7;">           </span><span style="color:#768390;"># 切换相机输出模式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6CB6FF;">printf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;\\n&quot;</span></span>
<span class="line"><span style="color:#6CB6FF;">echo</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-e</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;It is camera_mode </span><span style="color:#ADBAC7;">$mode</span><span style="color:#96D0FF;"> \\n&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="color:#6A737D;"># user@ubuntu:~/Stereo_cam/Camera_switch$ chmod +x ./camera_switch.sh      提升执行权限</span></span>
<span class="line"><span style="color:#6A737D;"># author : ruoxi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;%-10s\\n&quot;请输入相机通道</span></span>
<span class="line"><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id</span><span style="color:#24292E;">     </span><span style="color:#6A737D;"># 选取相机通道</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;It is switch to </span><span style="color:#24292E;">$id</span><span style="color:#032F62;"> \\n&quot;</span><span style="color:#24292E;">        </span><span style="color:#6A737D;"># -e 开启转义</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1.左单目模式：LEFT_EYE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;2.右单目模式：RIGHT_EYE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;3.红蓝模式：RED_BLUE_MODE\\n&quot;</span></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;4.双目模式：BINOCULAR_MODE\\n&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;%-10s\\n&quot;请输入相机输出模式序号</span></span>
<span class="line"><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mode</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 切换相机输出模式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;\\n&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:8</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;(LE)0x50ff&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:15</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;(LE)0x00f6&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:8</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;(LE)0x2500&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:8</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;(LE)0x5ffe&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:15</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;(LE)0x0003&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:15</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;(LE)0x0002&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:15</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;(LE)0x0012&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:15</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;(LE)0x0004&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:8</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;(LE)0x76c3&#39;</span></span>
<span class="line"><span style="color:#6F42C1;">uvcdynctrl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/dev/video</span><span style="color:#24292E;">\${id} </span><span style="color:#005CC5;">-S</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">:10</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;(LE)0x0\${</span><span style="color:#24292E;">mode</span><span style="color:#032F62;">}00&quot;</span><span style="color:#24292E;">           </span><span style="color:#6A737D;"># 切换相机输出模式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">printf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;\\n&quot;</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;It is camera_mode </span><span style="color:#24292E;">$mode</span><span style="color:#032F62;"> \\n&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>在 cpp 文件中直接使用 system(&quot;&quot;) 调用即可，关于相对路径，这里就不介绍了</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#DCBDFB;">system</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;../../sh/camera_switch.sh&quot;</span><span style="color:#ADBAC7;">);</span><span style="color:#768390;">  //Ubuntu 系统下，此处改成你的脚本存放相对路径</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">system</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;../../sh/camera_switch.sh&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">  //Ubuntu 系统下，此处改成你的脚本存放相对路径</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这里附上一款好用的配套上位机：<a href="https://github.com/ruoxi521/Stereo_QT/releases/tag/v1.0.0" target="_blank" rel="noreferrer">https://github.com/ruoxi521/Stereo_QT/releases/tag/v1.0.0</a></p><h3 id="问题二-如何在-ros-中使用节点调用摄像头显示双目图像" tabindex="-1">问题二：如何在 ROS 中使用节点调用摄像头显示双目图像 <a class="header-anchor" href="#问题二-如何在-ros-中使用节点调用摄像头显示双目图像" aria-label="Permalink to &quot;问题二：如何在 ROS 中使用节点调用摄像头显示双目图像&quot;">​</a></h3><p>这里附上一篇文章<a href="https://blog.csdn.net/shenyan0712/article/details/102483466" target="_blank" rel="noreferrer">ROS&amp;OpenCV 下单目和双目摄像头的标定与使用</a></p><p>这里是我的小伙伴提供的<a href="https://github.com/ruoxi521/Stereo_camera.git" target="_blank" rel="noreferrer">节点文件</a>，提供给大家参考。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">git</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">clone</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-b</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">melodic</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">https://github.com/ruoxi521/Stereo_camera.git</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-b</span><span style="color:#24292E;"> </span><span style="color:#032F62;">melodic</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/ruoxi521/Stereo_camera.git</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启动 camera_split 节点</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">user@ubuntu:~$</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">roslaunch</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">camera_split</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">stereo.launch</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">user@ubuntu:~$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">roslaunch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">camera_split</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stereo.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/5c47b091bad540a38482fbfb06792102.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Sm5YKR,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> 运行结果 <img src="https://img-blog.csdnimg.cn/a1fc5ddcb4ea46b58f748ae4c2149038.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Sm5YKR,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h3 id="问题三-如何测试双目摄像头跑通-orb-slam2" tabindex="-1">问题三：如何测试双目摄像头跑通 ORB-SLAM2 <a class="header-anchor" href="#问题三-如何测试双目摄像头跑通-orb-slam2" aria-label="Permalink to &quot;问题三：如何测试双目摄像头跑通 ORB-SLAM2&quot;">​</a></h3><p>修改 ORB_SLAM2/Examples/ROS/ORB_SLAM2/src/ros_stereo.cc 的两段代码，改为订阅 camera_split 节点/left_cam 和/right_cam 的/image_raw 话题</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">message_filters</span><span style="color:#ADBAC7;">::</span><span style="color:#F69D50;">Subscriber</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">sensor_msgs</span><span style="color:#ADBAC7;">::</span><span style="color:#F69D50;">Image</span><span style="color:#ADBAC7;">&gt; </span><span style="color:#DCBDFB;">left_sub</span><span style="color:#ADBAC7;">(</span><span style="color:#F69D50;">nh</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;/left_cam/image_raw&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#F69D50;">message_filters</span><span style="color:#ADBAC7;">::</span><span style="color:#F69D50;">Subscriber</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">sensor_msgs</span><span style="color:#ADBAC7;">::</span><span style="color:#F69D50;">Image</span><span style="color:#ADBAC7;">&gt; </span><span style="color:#DCBDFB;">right_sub</span><span style="color:#ADBAC7;">(</span><span style="color:#F69D50;">nh</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;/right_cam/image_raw&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">//message_filters::Subscriber&lt;sensor_msgs::Image&gt; left_sub(nh, &quot;/camera/left/image_raw&quot;, 1);</span></span>
<span class="line"><span style="color:#768390;">//message_filters::Subscriber&lt;sensor_msgs::Image&gt; right_sub(nh, &quot;camera/right/image_raw&quot;, 1);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">message_filters</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">Subscriber</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">sensor_msgs</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">Image</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">left_sub</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">nh</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/left_cam/image_raw&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6F42C1;">message_filters</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">Subscriber</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">sensor_msgs</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">Image</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">right_sub</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">nh</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/right_cam/image_raw&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//message_filters::Subscriber&lt;sensor_msgs::Image&gt; left_sub(nh, &quot;/camera/left/image_raw&quot;, 1);</span></span>
<span class="line"><span style="color:#6A737D;">//message_filters::Subscriber&lt;sensor_msgs::Image&gt; right_sub(nh, &quot;camera/right/image_raw&quot;, 1);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#6CB6FF;">cd</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">SLAM/src/ORB_SLAM2/Examples/ROS/ORB_SLAM2/</span></span>
<span class="line"><span style="color:#F69D50;">mkdir</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">build</span></span>
<span class="line"><span style="color:#6CB6FF;">cd</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">build</span></span>
<span class="line"><span style="color:#F69D50;">cmake</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">..</span></span>
<span class="line"><span style="color:#F69D50;">make</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SLAM/src/ORB_SLAM2/Examples/ROS/ORB_SLAM2/</span></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span></span>
<span class="line"><span style="color:#6F42C1;">cmake</span><span style="color:#24292E;"> </span><span style="color:#032F62;">..</span></span>
<span class="line"><span style="color:#6F42C1;">make</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>启动 camera_split 节点</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">user@ubuntu:~$</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">roslaunch</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">camera_split</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">stereo.launch</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">user@ubuntu:~$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">roslaunch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">camera_split</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stereo.launch</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">user@ubuntu:~$</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">roscore</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">user@ubuntu:~$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">roscore</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启动 Stereo 双目建图</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">user@ubuntu:~/SLAM/src/ORB_SLAM2$</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">rosrun</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">ORB_SLAM2</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">Stereo</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">Vocabulary/ORBvoc.txt</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">Examples/Stereo/EuRoC.yaml</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">user@ubuntu:~/SLAM/src/ORB_SLAM2$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rosrun</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ORB_SLAM2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Stereo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Vocabulary/ORBvoc.txt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Examples/Stereo/EuRoC.yaml</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>运行结果 <img src="https://img-blog.csdnimg.cn/adf7197f376948ad81d1051f8a5a3f78.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Sm5YKR,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> 细心的朋友可能发现，似乎只订阅了左边相机发布的话题，但是我们是设置其订阅左右两个相机发布的话题， <strong>这是为什么呢？</strong> 我想可能是对于双目 USB 相机，其输出的图像是经过合成的，我们通过软件方法分割左右相机的图像，同时对于需要同时订阅两个话题，需要对其作同步合并处理，之后作为参数进行传参。这里就不介绍具体过程，同学们可以自行探索解决。 可以参考这篇文章的思路<a href="https://blog.csdn.net/orange_littlegirl/article/details/97425696" target="_blank" rel="noreferrer">ROS 之订阅多个话题并对其进行同步处理 (多传感器融合)</a></p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>以上就是本文的内容，本文介绍了如何在 Ubuntu18.04 上用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2，本文写的比较粗糙，如有不足，还请指正。</p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><p>参考资料：</p><ol><li><a href="https://github.com/raulmur" target="_blank" rel="noreferrer">raulmur</a> ORB-SLAM2 <a href="https://github.com/raulmur/orb_slam2" target="_blank" rel="noreferrer">https://github.com/raulmur/orb_slam2</a></li><li>ROS <a href="http://wiki.ros.org/melodic/Installation/Ubuntu" target="_blank" rel="noreferrer">http://wiki.ros.org/melodic/Installation/Ubuntu</a>)</li></ol><h2 id="致谢" tabindex="-1">致谢 <a class="header-anchor" href="#致谢" aria-label="Permalink to &quot;致谢&quot;">​</a></h2><p>OK！本期关于如何在 Ubuntu18.04 上用 Opencv4.5.2+Melodic+USB 双目摄像头跑通 ORB-SLAM2 就到此为止。喜欢的话请支持、转发、订阅！同时也欢迎各位大佬指出不足之处！在此本人万分感谢！</p>`,38);function D(s,B,_,g,E,v){const o=r,e=c("ClientOnly");return l(),i("div",null,[A,y(e,null,{default:d(()=>{var a,n;return[(((a=s.$frontmatter)==null?void 0:a.aside)??!0)&&(((n=s.$frontmatter)==null?void 0:n.showArticleMetadata)??!0)?(l(),C(o,{key:0,article:s.$frontmatter},null,8,["article"])):b("",!0)]}),_:1}),h])}const x=t(m,[["render",D]]);export{k as __pageData,x as default};
